{% extends "base.jinja2" %}

{% block title %}Admin Login{% endblock title %}

{% block sidebar_breadcrumbs %}

    {{ super() }}
    <li class="nav-item active">
        <a class="nav-link py-1" href="{{ url_for('admin.index') }}">
            <span>Admin</span>
        </a>
    </li>

{% endblock sidebar_breadcrumbs %}

{% block regular_content %}

    {% block regular_content_top %}

        <div>
            <h1>Login Admin</h1>
        </div>

    {% endblock regular_content_top %}

    <!-- Login Card -->
    <div class="container-fluid m-2">
        <div class="text-center p-2 w-100">

            <!-- Student number display top bar -->
            <form class="mb-1" action="{{ url_for('admin.login') }}" method="post">
                <div class="vertical-input-group">
                    <div class="input-group login-display-sm mx-auto">
                        <input name="username" id="username" type="text" class="form-control h-100" value="" placeholder="Username">
                        <div class="input-group-append">
                            <button id="submit-button" type="submit" class="btn btn-primary">Next</button>
                        </div>
                    </div>
                    <div class="input-group login-display-sm mx-auto">
                        <input name="username" id="username" type="password" class="form-control h-100" value="" placeholder="Password"
                               disabled>
                    </div>
                </div>
            </form>

            <!-- Buttons -->
            <div class="btn-group" role="group">
                <button onclick="addDigit(1)" class="btn btn-outline-primary btn-sq m-1">1</button>
                <button onclick="addDigit(2)" class="btn btn-outline-primary btn-sq m-1">2</button>
                <button onclick="addDigit(3)" class="btn btn-outline-primary btn-sq m-1">3</button>
            </div>
            <br>
            <div class="btn-group" role="group">
                <button onclick="addDigit(4)" class="btn btn-outline-primary btn-sq m-1">4</button>
                <button onclick="addDigit(5)" class="btn btn-outline-primary btn-sq m-1">5</button>
                <button onclick="addDigit(6)" class="btn btn-outline-primary btn-sq m-1">6</button>
            </div>
            <br>
            <div class="btn-group" role="group">
                <button onclick="addDigit(7)" class="btn btn-outline-primary btn-sq m-1">7</button>
                <button onclick="addDigit(8)" class="btn btn-outline-primary btn-sq m-1">8</button>
                <button onclick="addDigit(9)" class="btn btn-outline-primary btn-sq m-1">9</button>
            </div>
            <br>
            <div class="btn-group" role="group">
                <button id="s-number-prefix-button" onclick="backToUsername()"
                        class="btn btn-outline-warning btn-sq m-1" disabled>&#171;
                </button>
                <button onclick="addDigit(0)" class="btn btn-outline-primary btn-sq m-1">0</button>
                <button onclick="removeDigit()" class="btn btn-outline-danger btn-sq m-1">&larr;</button>
            </div>

        </div>
    </div>

{% endblock regular_content %}

{% block script %}

    {{ super() }}

    <script type="text/javascript">

    // Adds clicked digit to display
    function addDigit(inputDigit) {
        let currentUsername = $('#username').val(); // Get the current username string
        if (currentUsername.length <= 12) { // Only if there are less than 12 numerical digits
            currentUsername += inputDigit; // Update the username
            $('#username').val(currentUsername); // Store and display the username
        }
    }

    // Removes last digit from the display
    function removeDigit() {
        let currentUsername = $('#username').val(); // Get the current username string
        if (currentUsername.length >= 1) { // If there are still digits in the username
            currentUsername = currentUsername.slice(0, -1); // Remove the last digit
        } else {  // If the string is already empty, do nothing
        }
        $('#username').val(currentUsername); // Store and display the username
    }

    // Toggle the prefix letter between 's' and 'm'
    function togglePrefix() {
        let currentSNumber = $('#s-number').val(); // Get the current student number string
        let currentSNumberDigits = currentSNumber.substring(1); // Removes the letter from the SNumber so only digits remain
        let oldPrefix = currentSNumber.charAt(0); // Get the prefix letter

        let newPrefix; // Declare the new prefix

        // toggle the prefix
        if (oldPrefix === 's') {
            newPrefix = 'm';
        } else if (oldPrefix === 'm') {
            newPrefix = 's';
        } else { // The prefix was not recognized, throw an alert
            alert('Oops! Something went wrong.');
        }

        currentSNumber = newPrefix + currentSNumberDigits  // Update the currentSNumber
        $('#s-number').val(currentSNumber); // Store the currentSNumber internally
        $('#s-number-prefix').text(newPrefix); // Display the new prefix
        $('#s-number-prefix-button').text(oldPrefix); // Display the new prefix
    }

</script>

{% endblock script %}